<!DOCTYPE html>
<html lang="pl" xmlns:th="http://www.thymeleaf.org">
    <head> 
        <meta charset="UTF-8"/>
        <meta name="patientPanel" content="width=device.width, initial-scale=1.0"/>
        <link rel="stylesheet" type="text/css" href="panelStyles.css"/>


        <title>loggingPanel</title>
    </head>
<body>
<header>
<div id="navbar">

    <button class="dropbtn" id="logo_pm" name="logo_pm"><img src="logo_premiummed.png" id="logo_img" height="50pxSSSSSS"></a></button>
    <div class="dropdown-content">
    </div>

    <button class="dropbtn" id="visits" name="visits"><a href="/visits">Wizyty</a></button>
    <div class="dropdown-content">
    </div>

    <button class="dropbtn" id="refferals" name="prescription"><a href="#">Skierowania</a></button>
    <div class="dropdown-content">
    </div>

    <button class="dropbtn" id="prescription" name="prescription"><a href="#">Recepty</a></button>
    <div class="dropdown-content">
    </div>

    <button class="dropbtn" id="newVisit" name="newVisit"><a href="#">Umów</a></button>
    <div class="dropdown-content">
    </div>

    <button class="dropbtn" id="log_out" name="log_out"><a href="/">Wyloguj</a></button>
    <div class="dropdown-content">
    </div>

    <script>
        document.getElementById('logo_pm').addEventListener('click', redirectToPatient);

        function redirectToPatient() {
            const urlParams = new URLSearchParams(window.location.search);
            const patientId1 = urlParams.get('patientId');

            if (patientId1) {
                const redirectUrl = `/patient?patientId=${patientId1}`;
                window.location.href = redirectUrl;
            } else {
                // Handle the case when patientId is not available
                console.error('PatientId: ', patientId1);
            }
        }
    </script>


</div>

</header>
<div class="all-container">
    <div id="main-wrapper">
        <div id="title-container">
            <p>TWOJE DANE</p>
        </div>
        <!--added till /ul-->
<!--        <div id="patientData">-->
<!--            <script>-->
<!--                fetch('/patient/all')-->
<!--                    .then(response => response.json())-->
<!--                    .then(data =>{-->
<!--                        data.forEach(patient => {-->
<!--                            const patientDiv = document.createElement('div');-->
<!--                            patientDiv.textContent = `Patient: ${patient.name} ${patient.surname}`;-->
<!--                            document.getElementById('patientData').appendChild(patientDiv);-->
<!--                        });-->
<!--                        }-->
<!--                    )-->
<!--                    .catch(error => console.error('Error fetching patient data', error))-->
<!--            </script>-->

        <div id="patientData">
            <script>
                const urlParams = new URLSearchParams(window.location.search);
                const patientId = urlParams.get('patientId');

                fetch(`/patient/all?patientId=${patientId}`)
                    .then(response => response.json())
                    .then(patient => {
                        const patientDiv = document.createElement('div');
                        patientDiv.textContent = `Patient: ${patient.name} ${patient.surname}`;
                        document.getElementById('patientData').appendChild(patientDiv);
                    })
                    .catch(error => console.error('Error fetching patient data', error))
            </script>
        </div>
    </div>
</div>

<footer>
    <div id="copyrights"><p>Projekt wykonany w ramach przedmiotu Inżynieria Programowania.</p></div>
    
</footer>
</body>

</html>